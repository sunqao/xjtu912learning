# 有理函数积分法与多项式除法

## 一些基本的概念

有理函数的积分是类似与下面的式子：
$$
\int \frac{a_1x^{m_1} + a_2x^{m_2}+...a_nx^{m_n}}{b_1x^{t_1} + b_2x^{t_2}+...b_nx^{t_n}} dx
$$
一般来讲有理函数可以分为两类：

**（1）真分式，指分子的幂要小于分母的幂**，比如下面的式子：
$$
\frac{1}{x + 1}
$$
**（2）假分式，指分子的幂要大于等于分母的幂**，比如下面的式子：
$$
\frac{2x^2 + 1}{x^2 + 1}
$$

> 对于假分式来说，其一定可以拆成 一个多项式与真分式的和，比如上面的式子可以拆成：
> $$
> \frac{2x^2 + 2 - 1}{x^2 + 1} = 2 - \frac{1}{x^2 + 1}
> $$
> 不过还有更一般的做法，可以直接用多项式除法来拆成一个多项式和真分式的和：
>
> <img src="https://typora-1310242472.cos.ap-nanjing.myqcloud.com/typora_img/image-20241115102419834.png" alt="image-20241115102419834" style="zoom:50%;" />
>
> 这里的多项式除法只要余数是小于$x^2 + 1$的式子就好了，于是可以得到：
> $$
> \frac{2(x^2 + 1) - 1}{x^2 + 1} = 2 - \frac{1}{x^2 + 1}
> $$
> 再举一个多项式除法的例子：
> $$
> \frac{x^3 - 12x^2 - 42}{x - 3}
> $$
> 多项式除法如下所示：
>
> <img src="https://typora-1310242472.cos.ap-nanjing.myqcloud.com/typora_img/image-20241115110347393.png" alt="image-20241115110347393" style="zoom:50%;" />
>
> 因此将假分式化为多项式和真分式之和为：
> $$
> \frac{(x - 3)(x^2 - 9x - 27) - 123}{x - 3} = x^2 - 9x - 27 - \frac{123}{x - 3}
> $$
> 
>
> 所以其实多项式除法就两个注意的步骤：
>
> （1）被除式和除式都进行降幂排列，并且空缺的项的系数补零
>
> （2）除法上系数的时候要保证被除式的最高幂可以被消掉
>
> （3）一直到余数的幂小于除式，这时候除法终止

## 处理的一般流程

### **（1）拆项，如果是假分式，拆成多项式与真分式的形式**



### **（2）对真分式的分母进行因式分解，我们可以得到一个这样的真分式：**

$$
\frac{P(x)}{Q(x)}
$$

其中Q(x)已经进行了因式分解

### **（3）对已经因式分解的真分式进行进一步的拆项，这一步有固定的套路：**

i 如果分母中有$(x - a)$，则拆出的项中有：$\frac{A}{x - a}$；如果分母中有$(x - a)^2$，则拆出的项有$\frac{A}{x - a} + \frac{B}{(x - a)^2}$；反正只要因式分解的一项是$(x - a)^k$，那么其就会对拆分的项贡献出：$\frac{A}{x - a} + \frac{B}{(x - a)^2} + \frac{C}{(x - a)^3}....\frac{D}{(x-a)^k}$

ii 如果分母中有$x^2 + px + q$，则拆出的项中就有：$\frac{Dx + E}{x^2 + px + q}$；同上，如果分母中有$(x^2 + px + q)^k$，那么其就会对拆分的项贡献出：$\frac{D_1x + E_1}{x^2 + px +q} + \frac{D_2x + E_2}{(x^2 + px +q)^2} + ....\frac{D_kx + E_k}{(x^2 + px +q)^k}$；但是像这种二次的一般就只考到k = 1，不会再多了

举个例子如下：
$$
\frac{3x + 6}{(x - 1)^2(x^2 + x + 1)} = \frac{A}{x - 1} + \frac{B}{(x - 1)^2} + \frac{Dx + E}{x^2 + x + 1}
$$

### **（4）确定拆项后的式子的系数：**

也就是确定上面式子的A，B，D，E，这里可以用待定系数法，对等式右边的式子进行通分，然后确定系数

> 但是这里介绍一种留数法，这里分别有几种情况来处理：
>
> **i 类似多种一次幂形成的项的系数确定，比如：$\frac{1}{(x - 1)(x - 2)} = \frac{A}{x-1} + \frac{B}{x - 2}$**
>
> 这里等式两边乘(x - 1)可以得到$\frac{1}{x - 2} = A + \frac{(x - 1)B}{x -2}$，这也是一个恒成立的式子，于是我们直接取x = 1就得到了A了，同理等式两边同时乘x - 2，然后x 取2就得到B了
>
> **ii 类似多种一次幂的次数大于2的形式，比如$\frac{1}{(x - 1)^2(x - 2)} = \frac{A}{x-1} +  \frac{B}{(x - 1)^2} + \frac{C}{x - 2}$**
>
> 这种情况如果确定B的系数就是两边同时乘$(x - 1)^2$，确定C的系数就是两边同时乘x - 2，当B，C的系数都确定之后由于上式是一个恒等式，可以随便令x = 0来确定A的系数
>
>  或者这个式子两边同时乘$(x - 1)^2$，然后对x求一次导，这样就可以将A这个系数裸露出来了，这时可以直接随便令x取指得到A
>
> 但是你最后只剩一个系数的时候就可以直接赋值求得
>
> **iii 类似分母二次幂形成的项的形式，比如$\frac{3x + 6}{(x - 1)^2(x^2 + x + 1)} = \frac{A}{x - 1} + \frac{B}{(x - 1)^2} + \frac{Dx + E}{x^2 + x + 1}$**
>
> 这种确定B很好做，两边同时乘$(x - 1)^2$，然后x 取1即可得到B = 3
>
> 确定A，两边同时乘$(x - 1)^2$之后对x求一次导，再令x = 1，可得A = -2
>
> 确定D，可以上面等式两边直接同时乘x，然后x趋于无穷，那么此时等式左右得到：
> $$
> 0 = A + 0 + D
> $$
> 因此D = 2
>
> 确定E，反正E就是最后一个数了，随便令x = 0得到E = 1
>
> 因此就得到了：
> $$
> \frac{3x + 6}{(x - 1)^2(x^2 + x + 1)} = \frac{A}{x - 1} + \frac{B}{(x - 1)^2} + \frac{Dx + E}{x^2 + x + 1} =  \frac{-2}{x - 1} + \frac{3}{(x - 1)^2} + \frac{2x + 1}{x^2 + x + 1}
> $$
> **所以留数法其实很简单，就是通过恒等变换看能不能将某个系数裸露出来，然后令x赋值得到对应的系数，常见的方法就是乘除恒等变换，求导，x取极限；其实我觉得甚至求积分也可以，实在求导某一步做不出来，剩下的系数直接用通分待定系数法也可以做**

### **（5）对拆分出来的式子进行积分：**

$$
\int \frac{3x + 6}{(x - 1)^2(x^2 + x + 1)} dx = \int \frac{A}{x - 1} + \frac{B}{(x - 1)^2} + \frac{Dx + E}{x^2 + x + 1}dx =  \int \frac{-2}{x - 1} + \frac{3}{(x - 1)^2} + \frac{2x + 1}{x^2 + x + 1}dx
$$

上面的式子的前两项很简单，关键是后面的一项$\int \frac{2x + 1}{x^2 + x + 1}dx$的处理

类似这种式子的处理其实有一个通用过程，就是将分子拆成分母的导数和一个常数：
$$
\int \frac{2x + 1}{x^2 + x + 1}dx = \int \frac{A(x^2 + x + 1)' + B}{x^2 + x + 1} dx= \int A \frac{(x^2 + x + 1)'}{x^2 + x + 1}dx + \int \frac{B}{x^2 + x + 1}dx
$$
这样做的逻辑有三个：

（1）分子是一定可以这样拆的，因为分子本来就是一个一次的式子，相当于拆乘了一个一次与一个常数，反正一定可以凑出来，并且拆分的系数也很简单

（2）拆成这样之后左边的项可以直接积分

（3）右边的项一定可以将分母写成平方式子所以我们可以得到：
$$
\int \frac{2x + 1}{x^2 + x + 1}dx = \int A \frac{(x^2 + x + 1)'}{x^2 + x + 1}dx + \int \frac{B}{x^2 + x + 1}dx = \int \frac{(x^2 + x + 1)'}{x^2 + x + 1}
$$
下面的积分就非常简单了

> 这里比较特殊，一般情况下，比如上式的分子如果是2的话可以拆成：
> $$
> \int \frac{2x + 2}{x^2 + x + 1}dx  = \int \frac{(x^2 + x + 1)'}{x^2 + x + 1} + \int \frac{1}{x^2 + x + 1} dx
> $$
> 进一步可以写成：
> $$
> \int \frac{2x + 2}{x^2 + x + 1}dx  = \int \frac{(x^2 + x + 1)'}{x^2 + x + 1} + \int \frac{1}{(x + \frac{1}{4})^2 + \frac{3}{4}} dx = \ln(x^2 + x + 1) + \frac{2}{\sqrt{3}} \arctan(\frac{x + \frac{1}{4}}{\frac{\sqrt{3}}{2}})
> $$

上面的所有内容就是有理积分的一般处理流程和需用yong'dao