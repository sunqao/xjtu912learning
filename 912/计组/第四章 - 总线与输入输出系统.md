# 第四章 - 总线与输入/输出系统

## 字符显示器的各个部件原理

字符显示器的结构如下所示：

![image-20240912180828101](https://typora-1310242472.cos.ap-nanjing.myqcloud.com/typora_img/image-20240912180828101.png)

首先是在屏幕上显示字符，字符显示器采用点阵法显示字符，即一个字符其实是由M * N行的屏幕上的点阵构成，比如一个字符A是由7 * 9的字符构成：

<img src="https://typora-1310242472.cos.ap-nanjing.myqcloud.com/typora_img/image-20240912181115560.png" alt="image-20240912181115560" style="zoom:67%;" />

字符显示器通过控制电子束一行行扫描这个字符所占据的点阵，然后在对应的行的上图深色位置标记，这样就可以在屏幕上显示字符了

屏幕上的字符所占的行和列的点阵以及字符之间的间隔合在一起称为字符窗口

**显示存储器VRAM**

VRAM用来存放整个屏幕的字符信息，因此其大小与屏幕的字符个数相对应，通常西文字符以ASCII码的形式存放在VRAM中，因此VRAM中的一个存储单元的最小宽度是一个字节

VRAM中的每个单元的地址是由屏幕上字符的行和列决定的，即VRAM的地址为字符所在的行号 * 一行的字符个数 + 字符所在的列号

其容量以及字符的地址举例如下所示：

![image-20240912183435926](https://typora-1310242472.cos.ap-nanjing.myqcloud.com/typora_img/image-20240912183435926.png)

**字符发生器ROM**

字符发生器的作用就是将VRAM中的字符编码（ASCII码）转化成二进制信息（也就是对应点阵信息，下文细嗦）存放到ROM中，然后显示的时候就根据这些二进制的编码（点阵信息）逐行扫描在屏幕上显示对应的字符

对于字符发生器的容量，其取决于整个字符集的大小和点阵规模，一个点阵就表示二进制的一个位存放到发生器ROM中，比如：

![image-20240912183818837](https://typora-1310242472.cos.ap-nanjing.myqcloud.com/typora_img/image-20240912183818837.png)

字符间隙是一个像素点，那么一个字符所占据的点阵的一行就不是7位，而是8位，也就是一个字节

对于字符发生器ROM中一个字符的起始地址，其由两部分构成，高地址部分来自VRAM中这个字符的ASCII码，低地址部分为这个字符在整个字符点阵中的行号

比如字符‘A’，其ASCII为41H，并且其在字符点阵中所在的行号又是0，所以其在ROM中的地址就是410H

字符A在字符点阵中所占据的是7列 * 9行，加上列间隔，其应该是8列 * 9行，如果再加上行间隔则应该是8列 * 11行

但是ROM中不存放行间隔，因此字符A所占据的点阵实际存放在ROM中应该是8列 * 9行，其显示在屏幕上的点阵如下所示：

![image-20240912184458847](https://typora-1310242472.cos.ap-nanjing.myqcloud.com/typora_img/image-20240912184458847.png)

这8列 * 9行点阵每一个点表示一个二进制，深色就是1，白色是0，8列*9行点阵可以看作9个连续的字节数，按照行的顺序从上到下是10H，28H, 44H, 82H, 82H, FEH, 82H, 82H, 82H

因此这个字符A存放在ROM中的规律就是起始地址为410H，然后连续9个字节分别存放上面的9个字节数

接着字符显示器的其他部分将这些字节数取出来分别按照这些二进制的1和0来控制亮度，控制电子束，这样就可以在屏幕的对应位置显示A了

当然这里应该是先有ROM中的存放方式，再有屏幕上的点阵显示，这里我们为了方便理解用屏幕点阵来说明，至于ROM中的存放方式其实是事先控制的，肯定是先控制，再显示