# 第四章习题-总线与IO系统

## 例 4.1 

![image-20240814192528098](https://typora-1310242472.cos.ap-nanjing.myqcloud.com/typora_img/image-20240814192528098.png)

**（1）**

而带宽是总线理论数据传输的最大值，所以一秒的所有时钟周期中总线全部传送数据，**也就是一个总线周期中的所有时钟周期都传输数据，这就是带宽了**，也就是1s能够传输数据的最大值

总线的时钟频率就是一秒有多少个总线时钟周期

每个时钟周期都传输数据，于是总线就是时钟频率乘位数了

带宽：`F = f * D = 33 M * 32 = 132 `MB/s 注意这里的M表示10^6的意思

但是总线并不是1s的每个时钟周期中都传输数据的，总线的一次完整的操作有四个阶段：

（1）申请分配，（2）寻址，（3）数据传送，（4）结束

以同步通信为例，这四个阶段构成了一个总线周期，包含了四个总线时钟周期，也就是说四个时钟周期中总线才传送一次数据，**也就是一个总线周期传送一次数据**，所以我们得求1s中有多少个总线周期，然后1s中的总线的周期个数乘32bit得到数据传输率

总线时钟周期：`T = 1 / f = 1/33M `s 注意这里的M表示10^6的意思

总线周期：`T' = 4T = 4 / f = 4 / 33M `s

1s中总线周期的个数：`1s/T’ = f / 4 = 33M / 4`个

实际数据传输率：`P = D * f / 4 = 32bit * (33M / 4) = 33`MB/s  注意这里的M表示10^6的意思

其实就是带宽除以4

**（2）**

总线时钟频率和带宽增加一倍

那么带宽有：`F = f * D = 33M * 2 * 32 * 2 = 528` MB/s

总线时钟周期：`T = 1 / f = 1 / (33MHz * 2)`s

总线周期：`T' = 2 / f = 2 / (33MHz * 2) = 1 / 33M`s

1s中的总线周期个数：`f / 2 = 33M`个

数据传输率：`D * f / 2 = 64 * 33M = 264 `MB /s 这里的M都是10^6的意思

**总线带宽是1s中的所有时钟周期都传输数据，即一个总线周期中的所有时钟周期都传输数据，实际数据传输率是一个总线周期只传一次数据，假设一个总线周期有k个时钟周期，所以实际数据传输率，就用带宽除以k即可**

## 例 4.2

![image-20240914193145897](https://typora-1310242472.cos.ap-nanjing.myqcloud.com/typora_img/image-20240914193145897.png)

**（1）**

这里的缓存容量，就是VRAM的容量

通常字符是以ASCII存放在VRAM中的，一个字符就占一个字节，因此VRAM中的一个存储单元就是一个字节，最大存储容量就是整个屏幕的整个所有字符，即：
$$
64 * 25 *8b = 12800b = 1600B
$$
**（2）**

ROM中存放的是整个字符集，一个字符在屏幕中占据的所有的点阵就表示ROM中的一个二进制的位

每个字符占据7 * 8的点阵，但是还有一像素的字间间隔，注意在这一章中像素点阵的7 * 8是7列8行 即 列*行，而不是一般的程序语言中的行 * 列，所以一个字符占据的点阵应该是8（列） * 8（行）

这个字符集有95个字符，所以ROM的大小至少为：
$$
95 * 8 * 8b= 760B
$$
**（3）**

显示是整个屏幕字符的ASCII码

**（4）**

缓存中的一个字符的地址构成是：
$$
字符所在的行号 * 每行的字符数 + 字符所在的列号
$$
屏幕中的字符显示是从上到下，从左到右显示的

因此VRAM中字符对应的地址也是从小到大与屏幕中的字符一一对应

**（5）**

**点计数器，其模是窗口的大小，在这里就是 7 + 1 = 8**

字计数器，其模是一行所显示的字数加上水平回扫的时间，计算的时候就用一行字符周期的个数代表

这道题目中的点频是14.896MHz，因此扫描一像素点的时间就是$T_点 = \frac{1}{14.896MHz}$

一个字符窗口的行长度是8因此扫描一个字符的长度的时间就是$T_字\frac{8}{14.896MHz}$

同理扫描一行像素点的时间就是$T_{行像素} = \frac{1}{24.5kHz}$

所以扫描一行像素点所扫描的字符的个数，也就是周期的个数就是：
$$
\frac{T_{行像素}}{T_字} = \frac{14.896MHz}{24.5KHz * 8} = 76个
$$
**所以字计数器的模就是76**

行计数器的模，行计数器加一就表示电子束扫描完了一行的像素点，其扫描完成计数达到模就表示电子束扫描完了一排的字符，所以这里得加上行间距，**因此行计数器的模就是字符窗口的高度，就是8 + 6 = 14**

排计数器加一表示扫描完了一排的字符，排计数器达到模就意味着电子束扫描完了整个屏幕，所以排计数器的模就是屏幕的字符的排数

但是排计数器模还得加上电子束垂直回扫的时间，所以这里用扫描一个屏幕时间中扫描的排的周期的个数代替

扫描完一个屏幕的时间就是帧的周期，即$T_{屏幕} = \frac{1}{50}$

行频率，即可以得到扫描一行的像素点的时间是$T_{行像素} = \frac{1}{24.5kHz}$

一排的字符有14行，因此扫描一排的字符的时间就是$T_{排} = \frac{14}{24.5KHz}$

所以扫描完整个屏幕所具有的排的周期个数就是：
$$
\frac{24.5K}{50 * 14} = 35
$$
因此排计数器的模就是35
